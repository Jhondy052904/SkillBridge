{% extends "registration/base.html" %}

{% block title %}Reset Password{% endblock %}

{% block content %}
<h2 class="section-title">Reset Your Password</h2>

<form id="resetForm" class="auth-form">
    <div class="form-group floating-label">
        <input type="password" id="new_password" placeholder=" " required>
        <label for="new_password">New Password</label>
    </div>

    <div class="form-group floating-label">
        <input type="password" id="confirm_password" placeholder=" " required>
        <label for="confirm_password">Confirm Password</label>
    </div>

    <button type="submit">Update Password</button>
</form>
<p style="margin-top: 15px; text-align: center;">
    <a href="{% url 'login' %}" class="btn" style="color: #1B3C53; font-size: 17px; text-decoration: none;">
        Back to Login
    </a>
</p>

<script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const supabase = createClient(
        "https://sfgnccdbgmewovbogibo.supabase.co", 
        "YOUR_PUBLIC_ANON_KEY"
    );

    document.getElementById("resetForm").addEventListener("submit", async (e) => {
        e.preventDefault();

        const newPassword = document.getElementById("new_password").value;
        const confirmPassword = document.getElementById("confirm_password").value;

        if (newPassword !== confirmPassword) {
            alert("Passwords do not match!");
            return;
        }

        const { error } = await supabase.auth.updateUser({ password: newPassword });

        if (error) {
            alert("Error resetting password: " + error.message);
        } else {
            alert("Password reset successful!");
            window.location.href = "{% url 'login' %}";
        }
    });
</script>


{% endblock %}
